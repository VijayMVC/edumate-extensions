/*
'a weekly summative report of attendance and lates for the school.'
To do: Counts, maybe period HR1 + HR2 only? Consult with Paul Hardwick
*/

SELECT
	CONTACT.SURNAME,
	CONTACT.FIRSTNAME,
	DATE_ON,
	LATE_TIME_IN,
	ATTEND_STATUS.ATTEND_STATUS,
	ABSENT_STATUS,
	START_TIME,
	END_TIME,
	CLASS_ID,
	EVENT_ID,
	PERIOD_ID,
	AM_PM_ID

FROM VIEW_ATTENDANCE VATTEND

INNER JOIN STUDENT ON STUDENT.STUDENT_ID = VATTEND.STUDENT_ID
INNER JOIN CONTACT ON CONTACT.CONTACT_ID = STUDENT.CONTACT_ID
INNER JOIN ATTEND_STATUS ON ATTEND_STATUS.ATTEND_STATUS_ID = VATTEND.ATTEND_STATUS_ID

WHERE
	DATE_ON BETWEEN (CURRENT_DATE - 7 DAYS) AND CURRENT_DATE
		AND
	VATTEND.ATTEND_STATUS_ID IN (3,4,5)

ORDER BY ATTEND_STATUS ASC, SURNAME ASC