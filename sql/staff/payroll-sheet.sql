/*
	To do: Casuals - talk with Louise/Eduard about how to do this
*/

SELECT
	CONTACT.FIRSTNAME || ' ' || CONTACT.SURNAME AS "FULLNAME",
	AWAY_REASON.AWAY_REASON,
	TO_CHAR((FROM_DATE), 'Month DD, YYYY') AS "START_DATE",
	TO_CHAR((TO_DATE), 'Month DD, YYYY') AS "END_DATE",
	DATE('[[Fortnight Beginning=date]]') AS "FNIGHT_BEGIN",
	DATE('[[Fortnight Ending=date]]') AS "FNIGHT_END",
	COMMENT AS "REASON",
	CASE WHEN SA.AWAY_REASON_ID IN (74,5) THEN COMMENT END AS "PD_REASON"

FROM STAFF_AWAY SA

INNER JOIN STAFF ON SA.STAFF_ID = STAFF.STAFF_ID
INNER JOIN CONTACT ON STAFF.CONTACT_ID = CONTACT.CONTACT_ID
INNER JOIN AWAY_REASON ON SA.AWAY_REASON_ID = AWAY_REASON.AWAY_REASON_ID

WHERE
	FROM_DATE >= DATE('[[Fortnight Beginning=date]]')
		AND
	TO_DATE <= DATE('[[Fortnight Ending=date]]')
	
ORDER BY AWAY_REASON, CONTACT.SURNAME, START_DATE, END_DATE