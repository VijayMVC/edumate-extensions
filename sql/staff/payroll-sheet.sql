SELECT
  CONTACT.FIRSTNAME || ' ' || CONTACT.SURNAME AS "FULLNAME",
  CONTACT.SURNAME,  
  AWAY_REASON.AWAY_REASON,
  FROM_DATE,
  TO_DATE,
  CASE WHEN FROM_DATE < DATE(CURRENT DATE - 14 DAYS) THEN TO_CHAR((CURRENT DATE - 14 DAYS), 'Month DD') ELSE TO_CHAR(FROM_DATE, 'Month DD - HH:MM PM') END AS EFFECTIVE_START,
  CASE WHEN TO_DATE > DATE(CURRENT DATE) THEN TO_CHAR((CURRENT DATE), 'Month DD') ELSE TO_CHAR(TO_DATE, 'Month DD - HH:MM PM') END AS EFFECTIVE_END,
  DATE(CURRENT DATE - 14 DAYS) AS "FNIGHT_BEGIN",
  DATE(CURRENT DATE) AS "FNIGHT_END",
  COMMENT AS "REASON",
  CASE WHEN SA.AWAY_REASON_ID IN (74,5) THEN COMMENT END AS "PD_REASON"
  
FROM STAFF_AWAY SA

INNER JOIN STAFF ON SA.STAFF_ID = STAFF.STAFF_ID
INNER JOIN CONTACT ON STAFF.CONTACT_ID = CONTACT.CONTACT_ID
INNER JOIN AWAY_REASON ON SA.AWAY_REASON_ID = AWAY_REASON.AWAY_REASON_ID

WHERE
  FROM_DATE <= DATE(CURRENT DATE)
    AND
  TO_DATE > DATE(CURRENT DATE - 14 DAYS)
 
ORDER BY SURNAME, AWAY_REASON